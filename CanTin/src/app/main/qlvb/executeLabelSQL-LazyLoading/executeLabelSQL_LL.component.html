<!-- <div [@routerTransition] (window:resize)="onResize($event)"> -->
    <div [@routerTransition]>
        <div class="kt-content  kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor">
            <div class="kt-subheader kt-grid__item">
                <div [class]="containerClass">
                    <div class="kt-subheader__main">
                        <h3 class="kt-subheader__title">
                            <span>{{header}}</span>
                        </h3>
                    </div>
                </div>
            </div>
            <div [class]="containerClass + ' kt-grid__item kt-grid__item--fluid'">
                <div class="kt-portlet kt-portlet--mobile">
                    <div class="modal-body">
                        <div class="row col-md-12" style="z-index: 1;">
                            <buttonUI #buttonUI (actionID)="getActionID($event)"></buttonUI>
                        </div>
                        <div class="row col-md-12">
                            <ng-template [ngIf]="labelId==85">
                                <dx-select-box #dataBookSelectBox id="dataBookSelectBox" [dataSource]="dataBook" [(value)]="timkiem.dataBook" displayExpr="name" valueExpr="id" (onValueChanged)="onValueChanged_book($event)" width="10%" [elementAttr]="{class: 'book_data'}"></dx-select-box>
                                &nbsp;
                                <dx-select-box #monthSelectBox id="monthSelectBox" [dataSource]="month" [(value)]="timkiem.month" displayExpr="name" valueExpr="id" (onValueChanged)="onValueChanged_month($event)" width="10%" [elementAttr]="{class: 'book_data'}"></dx-select-box>
                                &nbsp;
                            </ng-template>
                            <dx-text-box #noidungTextBox id="noidungTextBox" placeholder="Nội dung tìm kiếm ..." [(value)]="timkiem.noidung" width="400px"></dx-text-box>
                            &nbsp;
                            <dx-button text="Tìm kiếm" type="success" icon="search" (onClick)="search()"></dx-button>
                            &nbsp;
                            <dx-button text="Làm mới" type="normal" icon="refresh" (onClick)="clear()"></dx-button>
                        </div>
                       <div class="row align-items-center">
                            <!--<Primeng-TurboTable-Start>-->
                            <div class="col primeng-datatable-container">
                                <dx-data-grid #gridContainer id="gridContainer" [showColumnLines]="true" [showRowLines]="true"
                                    [(selectedRowKeys)]="selectedRowsData" (onSelectionChanged)="selectionChangedHandler()"
                                    (onRowDblClick)="startEdit($event)" [showBorders]="true" [allowColumnResizing]="true"
                                    [columnAutoWidth]="true" [(dataSource)]="initialData" [cellHintEnabled]="true"
                                    (onToolbarPreparing)="onToolbarPreparing($event)" [remoteOperations]="true">
                                    <dxo-scrolling mode="standard" [scrollByContent]="true" [scrollByThumb]="true"
                                        showScrollbar="always">
                                        <!-- or "virtual" | "infinite" -->
                                    </dxo-scrolling>
                                    <dxo-selection mode="multiple"> </dxo-selection>
                                    <!-- <dxo-export [enabled]="true" fileName="Documents" [allowExportSelectedData]="true">
                                    </dxo-export> -->
                                    <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[20, 50, 100]"
                                        [showInfo]="true" [showNavigationButtons]="true"></dxo-pager>
                                    <!-- <dxo-search-panel [visible]="true" placeholder="Nhập nội dung..." width="300">
                                    </dxo-search-panel> -->
                                    <!-- <dxo-header-filter [visible]="true"></dxo-header-filter> -->
                                    <dxo-filter-row [visible]="false"></dxo-filter-row>
                                    <!-- <dxo- <dxo-filter-panel [visible]="true"></dxo-filter-panel>column-chooser [enabled]="true"></dxo-column-chooser> -->
                                    <dxo-paging [enabled]="true" [pageSize]="20"></dxo-paging>
                                    <dxi-column type="selection" [width]="3+'%'"></dxi-column>
                                    <dxi-column dataField="stt" columnIndex="1" caption="STT" alignment="center" cellTemplate="sttTemplate"
                                        [width]="5+'%'"></dxi-column>
                                    <dxi-column columnIndex="9" alignment="center" [width]="6+'%'"
                                        cellTemplate="customTemplate" caption="Xử lý"></dxi-column>
                                    <!-- <dxi-column dataField="action_button " columnIndex="2" cellTemplate="actionTemplate"
                                            caption="#" [width]="8+'%'" alignment="center"></dxi-column> -->
                                    <dxi-column cellTemplate="diffCellTemplate" [allowSearch]="true"
                                        headerCellTemplate="titleHeaderTemplate" columnIndex="3" [width]="11+'%'"
                                        dataType="date" format="d/M/yyyy" alignment="center">
                                    </dxi-column>
                                    <dxi-column dataField="PublisherName" columnIndex="7"
                                        headerCellTemplate="titleHeaderTemplate2" [width]="10+'%'">

                                    </dxi-column>
                                    <dxi-column dataField="IncommingNumber" [visible]="false">
                                    </dxi-column>
                                    <dxi-column dataField="Number" [visible]="false">
                                    </dxi-column>

                                    <dxi-column [allowSearch]="true" columnIndex="4" cellTemplate="diffCellTemplate1"
                                        headerCellTemplate="titleHeaderTemplate1" alignment="center" [width]="9+'%'">
                                    </dxi-column>
                                    <dxi-column columnIndex="5" cellTemplate="diffCellTemplate3"
                                        headerCellTemplate="titleHeaderTemplate3" alignment="center" [width]="9+'%'"
                                        dataType="date" format="d/M/yyyy">

                                    </dxi-column>
                                    <dxi-column dataField="Summary" cellTemplate="summaryTemplate" columnIndex="8" [width]="19+'%'" caption="Trích yếu">
                                    </dxi-column>
                                    <dxi-column dataField="ProcessingRecommended" cellTemplate="summaryTemplate" headerCellTemplate="titleHeaderTemplate4"
                                        columnIndex="6" [width]="16+'%'">
                                    </dxi-column>
                                    <dxi-column columnIndex="6" [width]="10+'%'"
                                        headerCellTemplate="titleHeaderTemplate5" cellTemplate="diffCellTemplate5">
                                    </dxi-column>
                                    <dxi-column dataField="IsHandled" caption="Trạng thái" [width]="8+'%'" [visible]="labelId>84">
                                    </dxi-column>

                                    <div *dxTemplate="let d of 'summaryTemplate'">
                                        <p placement="bottom" [tooltip]="d.value" style="max-height: 75px; text-align: justify;">
                                            {{d.value}}
                                        </p>
                                    </div>
                                    <div *dxTemplate="let cell of 'sttTemplate'">
                                        <span>{{ cell.rowIndex + 1 }}</span>
                                    </div>

                                    <div *dxTemplate="let info of 'titleHeaderTemplate4'">
                                        <div class="current-value" style="text-align: center;">Ý kiến đề</div>
                                        <div class="diff" style="text-align: center;">xuất PV01</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate'">
                                        <div class="current-value">Số VB đến</div>
                                        <div class="diff">Ngày VB đến</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate3'">
                                        <div class="current-value">Hạn </div>
                                        <div class="diff"> giải quyết</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate2'"
                                        style="text-align: center !important">
                                        <div class="current-value">Nơi phát</div>
                                        <div class="diff">hành</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate1'">
                                        <div class="current-value">Số đến</div>
                                        <div class="diff">Ngày đến</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate4'">
                                        <div class="current-value">Ý kiến đề xuất</div>
                                        <div class="diff">PV01</div>
                                    </div>
                                    <div *dxTemplate="let info of 'titleHeaderTemplate5'">
                                        <div class="current-value">Chỉ đạo</div>
                                        <div class="diff">BGĐ</div>
                                    </div>

                                    <div *dxTemplate="let d of 'customTemplate'">
                                        <div class="btn-group dropdown btn-smaller-padding" dropdown container="body">
                                            <button class="dropdown-toggle btn btn-sm btn-primary" dropdownToggle>
                                                <i class="fa fa-cog"></i>
                                            </button>
                                            <ul class="dropdown-menu" *dropdownMenu>
                                                <!-- <li *ngIf="num.includes(2)">
                                                        <a href="javascript:;" (click)="saveToBook(d)"><i class="fas fa-atlas"
                                                                style="color: rgb(7, 88, 44);"></i>{{l('Vào sổ')}}</a>

                                                    </li> -->
                                                <li *ngIf="num.includes(4)">
                                                    <a href="javascript:;" (click)="editRow(d)"><i class="fas fa-edit"
                                                            style="color: rgb(7, 88, 44);"></i>Sửa</a>
                                                </li>
                                                <li *ngIf="num.includes(1)">
                                                    <a href="javascript:;" (click)="viewRow(d)"><i class="fas fa-eye"
                                                            style="color: rgb(7, 88, 44);"></i>Xem</a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;" (click)="exportHTML(d, d.data)"><i
                                                            class="fas fa-print"
                                                            style="color: rgb(7, 88, 44);"></i>In phiếu trình</a>
                                                </li>
                                                <li *ngIf="num.includes(25)">
                                                    <a href="javascript:;" (click)="trinhBGD(d)"> <i class="fas fa-user-tie"
                                                            style="color: rgb(7, 88, 44);"></i>Trình BGĐ</a>
                                                </li>
                                                <li *ngIf="num.includes(27)">
                                                    <a href="javascript:;" (click)="editExtra(d.data)"><i
                                                            class="fas fa-plus-square"
                                                            style="color: rgb(7, 88, 44);"></i>Sửa</a>
                                                </li>
                                                <!-- <li *ngIf="num.includes(28)">
                                                    <a href="javascript:;" (click)="transferExtra(d)"><i class="fas fa-plus"
                                                            style="color: rgb(7, 88, 44);"></i>Chuyển bổ sung</a>
                                                </li> -->
                                                <li *ngIf="num.includes(26)">
                                                    <a href="javascript:;" (click)="startEdit(d)"><i
                                                            class="fas fa-trash-alt"
                                                            style="color: rgb(7, 88, 44);"></i>Cập nhật KQGQ</a>
                                                </li>
                                                <li *ngIf="num.includes(3)">
                                                    <a href="javascript:;" (click)="deleteRow(d)"><i
                                                            class="fas fa-trash-alt"
                                                            style="color: rgb(7, 88, 44);"></i>Xóa</a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;" (click)="viewProcess(d)"><i class="fa fa-cog"
                                                            style="color: rgb(7, 88, 44);"></i>Quy trình xử lý</a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;" (click)="showListHistory(d.data.Id)"><i
                                                            class="fa fa-file"
                                                            style="color: rgb(7, 88, 44);"></i>Tệp đính kèm</a>
                                                </li>
                                                <li *ngIf="d.data.FileChiDao">
                                                    <a href="javascript:;" (click)="showFileChiDao(d.data)"><i
                                                            class="fa fa-file"
                                                            style="color: rgb(7, 88, 44);"></i>Tệp ý kiến chỉ đạo</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div *dxTemplate="let d of 'actionTemplate'">
                                        <div class="row">
                                            <div class="col-6">
                                                <span (click)="viewProcess(d)" style="position: absolute; top: 10px"> <i
                                                        class="fas fa-share-alt"></i></span>
                                            </div>
                                            <div class="col-6">
                                                <span (click)="showListHistory(d)"><i class="fas fa-file-pdf"></i></span>
                                                <br>
                                                <span (click)="instaff(d)"><i
                                                        [ngStyle]="{'color' : d.data.star == true ? '#d41022e8': 'black'}"
                                                        class="fas fa-star" id=d.data.id></i></span>
                                            </div>
                                            <!-- <div class="col-4"    >
                                            </div> -->
                                        </div>
                                    </div>
                                    <div *dxTemplate="let d of 'diffCellTemplate'">
                                        <div class="current-value" style="font-weight: bold;">{{d.data.Number}}</div>
                                        <div class="diff">{{d.data.PublishDate | date: "dd/MM/yyyy " }}</div>
                                    </div>
                                    <div *dxTemplate="let d of 'diffCellTemplate1'">
                                        <div class="current-value" style="font-weight: bold;">{{d.data.IncommingNumber}}
                                        </div>
                                        <div class="diff">{{d.data.IncommingDate | date: "dd/MM/yyyy "}}</div>
                                    </div>
                                    <div *dxTemplate="let d of 'diffCellTemplate3'">
                                        <div class="current-value" style="font-weight: bold;font-style: italic;">
                                            {{d.data.Deadline | date: "dd/MM/yyyy " }}</div>
                                    </div>
                                    <div *dxTemplate="let d of 'diffCellTemplate5'">
                                        <ng-template #tolTemplate>
                                            <div *ngIf="d.data.ApprovingRecommended" class="font-b" style="color: red">{{d.data.DirectorName}}</div>
                                            <div *ngIf="d.data.ApprovingRecommended"  class="font-i diff">{{d.data.ApprovingRecommended}}</div>
                                            <!-- <div *ngIf="d.data.ApprovingRecommended" class="font-b" style="color: blue">{{d.data.DirectorName}}</div>
                                            <div *ngIf="d.data.ApprovingRecommended"  class="font-i diff">{{d.data.SubApprovingRecommended}}</div> -->
                                            <div *ngIf="d.data.ProcessingRecommended && labelId != 6" class="font-i"><b>PV01 đx:</b> {{d.data.ProcessingRecommended}}</div>
                                        </ng-template>
                                        <div [tooltip]="tolTemplate" placement="left" style="max-height: 150px;">
                                            <div *ngIf="d.data.ApprovingRecommended" class="font-b" style="color: red">{{d.data.DirectorName}}</div>
                                            <div *ngIf="d.data.ApprovingRecommended"  class="font-i diff">{{d.data.ApprovingRecommended}}</div>
                                            <!-- <div *ngIf="d.data.ApprovingRecommended" class="font-b" style="color: blue">{{d.data.DirectorName}}</div>
                                            <div *ngIf="d.data.ApprovingRecommended"  class="font-i diff">{{d.data.SubApprovingRecommended}}</div> -->
                                            <div *ngIf="d.data.ProcessingRecommended && labelId != 6" class="font-i"><b>PV01 đx:</b> {{d.data.ProcessingRecommended}}</div>
                                        </div>
                                    </div>
                                    <div *dxTemplate="let data of 'totalGroupCount'">
                                        <div style="font-style: italic;">
                                            <span>Có <b>{{totalCount}}</b> kết quả tìm kiếm</span>
                                        </div>
                                    </div>
                                </dx-data-grid>
                                <!-- Xem lịch sử upload chi tiết -->
                                <dx-popup [width]="800" [height]="600" [showTitle]="true" title="Danh sách file đính kèm"
                                    [dragEnabled]="false" [closeOnOutsideClick]="false" [(visible)]="historyPopupVisible">
                                    <dx-data-grid id="gridContainer" [(dataSource)]="history_Upload"
                                        [allowColumnReordering]="true" [allowColumnResizing]="true" [columnAutoWidth]="true"
                                        [showBorders]="true" [noDataText]="'Không có tệp đính kèm'">
                                        <dxo-paging [pageSize]="10"></dxo-paging>
                                        <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20]"
                                            [showInfo]="true">
                                        </dxo-pager>

                                        <dxi-column dataField="tepDinhKem" caption="Tệp đính kèm"></dxi-column>
                                        <!-- <dxi-column dataField="version"></dxi-column> -->
                                        <dxi-column type="buttons" dataField="Xem chi tiết">
                                            <dxi-button [onClick]="showDetail" icon="fab fa-buffer"></dxi-button>
                                        </dxi-column>

                                    </dx-data-grid>
                                </dx-popup>

                                <!-- Trình lãnh đạo -->
                                <dx-popup [width]="600" [height]="250" [showTitle]="true" title="Danh sách BGĐ"
                                    [dragEnabled]="false" [closeOnOutsideClick]="false" [(visible)]="popup_Visible">
                                    <dx-form [showValidationSummary]="true" validationGroup="formValidateGroup">
                                        <dxi-item itemType="group" cssClass="item-bold">
                                            <div class="row">
                                                <div class="col-2" style="font-size: 15px;font-weight: bold;"> Chọn BGĐ:
                                                </div>
                                                <div class="col-10">
                                                    <dx-select-box #BGDSelectBox [dataSource]="director_list"
                                                        displayExpr="nameWithPosition" valueExpr='userId'
                                                        [(value)]="selectedDirector">
                                                    </dx-select-box>
                                                </div>
                                            </div>
                                        </dxi-item>
                                    </dx-form>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div style="display: block; margin-left: auto; margin-right: auto; width: 130px;">
                                            <dx-button type="success" icon="fa fa-save" text="Trình BGĐ"
                                                (onClick)="change_director()"></dx-button>
                                        </div>
                                    </div>

                                </dx-popup>

                                <!--Cập nhật chỉ đạo BGĐ -->

                                <dx-popup [width]="1200" [height]="'auto'" [showTitle]="true"
                                    title=" Cập nhật ý kiến chỉ đạo BGĐ" [dragEnabled]="false" [closeOnOutsideClick]="false"
                                    [(visible)]="popup_Visible_detail">
                                    <dx-form [formData]="dataRowDetail" [showValidationSummary]="true"
                                        validationGroup="formValidateGroup">
                                        <dxi-item dataField="ProcessingRecommended" [cssClass]="popUpClass()"
                                            [editorOptions]="{ disabled: true }">
                                            <dxo-label text="Ý kiến đề xuất của PV01"></dxo-label>
                                            <!-- <label>Ý kiến đề xuất của PV01</label> -->
                                        </dxi-item>

                                        <dxi-item itemType="group" [colSpan]="2" colCount="12">
                                            <!-- <dxi-item itemType="group" [colSpan]="6" colCount="12">
                                                <dxi-item dataField="FileChiDao" [colSpan]="12">
                                                    <dxo-label text="Tập tin chỉ đạo"></dxo-label>
                                                    <dx-file-uploader   [multiple]="true"
                                                        selectButtonText="Chọn file đính kèm"
                                                        labelText="Kéo thả file vào để upload" accept="*" icon="upload"
                                                        [(value)]="uploadedFileChiDao"  uploadMode="useForm"
                                                        (onValueChanged)="setFullNameFile($event)" [showFileList]="true">
                                                    </dx-file-uploader>
                                                </dxi-item>
                                                <dxi-item [colSpan]="12">
                                                    <dxo-label text="Scan văn bản"></dxo-label>
                                                    <dxi-validation-rule type="required"></dxi-validation-rule> -->
                                                    <!-- <dx-button [disabled]="saving" text="Scan" type="success" icon="search"
                                                        (onClick)="scan()">
                                                    </dx-button>

                                                </dxi-item>
                                            </dxi-item> -->
                                            <dxi-item itemType="group" [colSpan]="6" colCount="12">
                                                <dxi-item [colSpan]="12">
                                                    <dxo-label text="Tập tin"></dxo-label>
                                                    <!-- <dxi-validation-rule type="required"></dxi-validation-rule> -->
                                                    <dx-file-uploader

                                                        [multiple]="true"
                                                        selectButtonText="Chọn file đính kèm"
                                                        accept="*"
                                                        icon="upload"
                                                        [(value)]="uploadedFileChiDao"
                                                         uploadMode="useForm"
                                                        (onValueChanged)="setFullNameFile($event)">
                                                    </dx-file-uploader>
                                                </dxi-item>
                                                <dxi-item [colSpan]="6">
                                                    <dxo-label text="Scan văn bản"></dxo-label>
                                                    <dx-button [disabled]="saving" text="Scan" type="success" icon="search"
                                                        (onClick)="scan()">
                                                    </dx-button>
                                                </dxi-item>
                                                <dxi-item [colSpan]="6">
                                                    <dx-radio-group
                                                        [dataSource]="scanTypes"
                                                        displayExpr="display"
                                                        valueExpr="value"
                                                        [(value)]="scanType"
                                                        (onValueChanged)="onScanTypeChanged($event)">
                                                    </dx-radio-group>
                                                </dxi-item>
                                            </dxi-item>

                                            <dxi-item [colSpan]="6">
                                                <dx-data-grid id="gridContainer" [dataSource]="selectedRowsFile"
                                                    [allowColumnReordering]="true" [allowColumnResizing]="true"
                                                    [columnAutoWidth]="true" [showBorders]="true">
                                                    <dxo-paging [pageSize]="10"></dxo-paging>
                                                    <dxo-pager [showPageSizeSelector]="true"
                                                        [allowedPageSizes]="[5, 10, 20]" [showInfo]="true">
                                                    </dxo-pager>
                                                    <dxi-column dataField="tepDinhKem" caption="Tệp đính kèm"></dxi-column>
                                                    <dxi-column caption="Xem chi tiết" cellTemplate="detailTemplate"
                                                        [width]="100">
                                                    </dxi-column>
                                                    <dxi-item caption="Xóa" cellTemplate="deleteTemplate">
                                                    </dxi-item>

                                                    <div *dxTemplate="let d of 'detailTemplate'">
                                                        <div class="row">
                                                            <div class="col-6" style="text-align: center;"
                                                                (click)="showDetail(d)">
                                                                <span><i class="fab fa-buffer"></i></span>
                                                            </div>
                                                            <div class="col-6" style="text-align: center;"
                                                                (click)="deleteFile(d)">
                                                                <span><i class="fas fa-trash-alt"></i> </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *dxTemplate="let d of 'deleteTemplate'">
                                                        <div class="col-2" style="text-align: center;"
                                                            (click)="deleteFile(d)">
                                                            <span><i class="fas fa-trash-alt"></i> </span>
                                                        </div>
                                                    </div>
                                                </dx-data-grid>
                                            </dxi-item>
                                        </dxi-item>

                                        <dxi-item [colSpan]="2" dataField="DirectorId" editorType="dxSelectBox"
                                            [editorOptions]="{
                                                valueExpr: 'userId',
                                                displayExpr: 'nameWithPosition',
                                                searchEnabled: true,
                                                searchExpr: 'fullName',
                                                dataSource: director_list,
                                                value: null,
                                                readOnly: true
                                            }">
                                            <dxo-label text="BGĐ"></dxo-label>
                                        </dxi-item>

                                        <dxi-item dataField="ApprovingRecommended" [colCount]="2" [colSpan]="2"
                                            editorType="dxTextArea" [editorOptions]="{ autoResizeEnabled: true }"
                                            [cssClass]="popUpClass()">
                                            <dxo-label text="Ý kiến chỉ đạo của BGĐ"></dxo-label>
                                        </dxi-item>

                                        <dxi-item [colSpan]="2" dataField="SubApprovingRecommended" editorType="dxTextArea" [visible]="false">
                                            <dxo-label text="Ý kiến chỉ đạo của phó GĐ"></dxo-label>
                                        </dxi-item>

                                        <dxi-item [colSpan]="2">
                                            <br>
                                            <dxo-label text="Đơn vị xử lý"></dxo-label>
                                            <dx-data-grid #gridContainer113 id="gridContainer113" [remoteOperations]="false"
                                                [allowColumnReordering]="true" [rowAlternationEnabled]="true"
                                                [allowColumnResizing]="true" columnResizingMode="widget"
                                                [showBorders]="true" [height]="250" [dataSource]="data_DVXL">
                                                <dxo-paging [enabled]="false"></dxo-paging>
                                                <!-- <dxo-editing mode="cell" [allowUpdating]="true">
                                                    </dxo-editing> -->
                                                <dxo-filter-row [visible]="true" placeholder="Nhập tên phòng...">
                                                </dxo-filter-row>
                                                <dxi-column [allowFiltering]="true" [allowEditing]="false"
                                                    caption="Danh sách phòng" dataField="displayName" dataType="string"
                                                    width="50%">
                                                </dxi-column>

                                                <dxi-column [allowFiltering]="true" [allowEditing]="false"
                                                    [allowEditing]="false" caption="Kí hiệu" dataField="shortentCode"
                                                    width="10%">
                                                </dxi-column>
                                                <dxi-column [allowEditing]="true" [allowFiltering]="false"
                                                    dataField="mainHandling" cellTemplate="selectTemplate" caption="Chủ trì"
                                                    width="20%" dataType="boolean" alignment="center">
                                                </dxi-column>
                                                <dxi-column cellTemplate="selectTemplate" [allowEditing]="true"
                                                    [allowFiltering]="false" dataField="coHandling"
                                                    caption="Phối hợp xử lý " width="20%" dataType="boolean"
                                                    alignment="center">
                                                </dxi-column>
                                                <div *dxTemplate="let cell of 'selectTemplate'">
                                                    <dx-check-box [value]="cell.value"
                                                        (onValueChanged)="onCheckBoxChanged($event, cell)"></dx-check-box>
                                                </div>
                                            </dx-data-grid>

                                        </dxi-item>

                                    </dx-form>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div style="display: block; margin-left: auto; margin-right: auto; width: 130px;">
                                            <dx-button [disabled]="saving" type="success" icon="fa fa-save" text="Cập nhật"
                                                (onClick)="update_ykien()"></dx-button>
                                        </div>
                                    </div>

                                </dx-popup>

                                <!-- tệp đính kèm chỉ đạo -->
                                <dx-popup [width]="600" [height]="'auto'" [showTitle]="true"
                                    title="Danh sách tệp ý kiến chỉ đạo BGĐ" [dragEnabled]="false"
                                    [closeOnOutsideClick]="false" [(visible)]="popup_FileChiDao">
                                    <dx-form [formData]="dataFileChiDaoDetail" [showValidationSummary]="true"
                                        validationGroup="formValidateGroup">

                                        <dxi-item itemType="group" [colSpan]="2" colCount="12">

                                            <dxi-item [colSpan]="12">
                                                <dx-data-grid id="gridContainer" [dataSource]="selectedRowsFileChiDao"
                                                    [allowColumnReordering]="true" [allowColumnResizing]="true"
                                                    [columnAutoWidth]="true" [showBorders]="true">
                                                    <dxo-paging [pageSize]="10"></dxo-paging>
                                                    <dxo-pager [showPageSizeSelector]="true"
                                                        [allowedPageSizes]="[5, 10, 20]" [showInfo]="true">
                                                    </dxo-pager>
                                                    <dxi-column dataField="fileName" caption="Tệp đính kèm"></dxi-column>
                                                    <dxi-column caption="Xem chi tiết" cellTemplate="detailTemplate"
                                                        [width]="100">
                                                    </dxi-column>
                                                    <dxi-item caption="Xóa" cellTemplate="deleteTemplate">
                                                    </dxi-item>

                                                    <div *dxTemplate="let d of 'detailTemplate'">
                                                        <div class="row">
                                                            <div class="col-12" style="text-align: center;"
                                                                (click)="showFileChiDaoDetail(d)">
                                                                <span><i class="fab fa-buffer"></i></span>
                                                            </div>
                                                            <!-- <div class="col-6" style="text-align: center;" (click)="deleteFile(d)">
                                                                <span><i class="fas fa-trash-alt"></i> </span>
                                                            </div> -->
                                                        </div>
                                                    </div>
                                                    <!-- <div *dxTemplate="let d of 'deleteTemplate'">
                                                        <div class="col-2" style="text-align: center;" (click)="OK(d)">
                                                            <span ><i class="fas fa-trash-alt"></i> </span>
                                                        </div>
                                                    </div> -->
                                                </dx-data-grid>
                                            </dxi-item>
                                        </dxi-item>


                                    </dx-form>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div style="display: block; margin-left: auto; margin-right: auto; width: 130px;">
                                            <dx-button [disabled]="saving" type="success" icon="fa fa-save" text="Đóng"
                                                (onClick)="close_fileChiDaoPopUp()"></dx-button>
                                        </div>
                                    </div>

                                </dx-popup>

                                <!-- Chuyển bổ sung -->
                                <dx-popup [width]="900" [height]="600" [showTitle]="true" title="Chuyển bổ sung"
                                    [dragEnabled]="false" [closeOnOutsideClick]="false"
                                    (onDisposing)="onDisposingChuyenBoSung($event)" [(visible)]="popup_chuyenBoSung">
                                    <dx-form [formData]="dataRowDetail" [showValidationSummary]="true"
                                        validationGroup="formValidateGroup">
                                        <dxi-item [label]="{text: 'Ý kiến đề xuất'}" dataField="ProcessingRecommended"
                                            [editorOptions]="{ disabled: true }" [cssClass]="popUpClass()">
                                        </dxi-item>
                                        <dxi-item [label]="{text: 'Ý kiến chỉ đạo của BGĐ'}"
                                            dataField="ApprovingRecommended" [colCount]="2" [colSpan]="2"
                                            editorType="dxTextArea" [editorOptions]="{ autoResizeEnabled: true }"
                                            [cssClass]="popUpClass()">
                                        </dxi-item>

                                        <dxi-item [colSpan]="2">
                                            <br>
                                            <dxo-label text="Đơn vị xử lý"></dxo-label>
                                            <dx-data-grid #gridContainer113 id="gridContainer113" [remoteOperations]="false"
                                                [allowColumnReordering]="true" [rowAlternationEnabled]="true"
                                                [allowColumnResizing]="true" columnResizingMode="widget"
                                                [showBorders]="true" [height]="250" [dataSource]="data_DVXL">
                                                <dxo-paging [enabled]="false"></dxo-paging>
                                                <!-- <dxo-editing mode="cell" [allowUpdating]="true">
                                                    </dxo-editing> -->
                                                <dxo-filter-row [visible]="true" placeholder="Nhập tên phòng...">
                                                </dxo-filter-row>
                                                <dxi-column [allowFiltering]="true" [allowEditing]="false"
                                                    caption="Danh sách phòng" dataField="displayName" dataType="string"
                                                    width="50%">
                                                </dxi-column>

                                                <dxi-column [allowFiltering]="true" [allowEditing]="false"
                                                    [allowEditing]="false" caption="Kí hiệu" dataField="shortentCode"
                                                    width="10%">
                                                </dxi-column>
                                                <dxi-column [allowEditing]="true" [allowFiltering]="false"
                                                    dataField="mainHandling" cellTemplate="selectTemplateCT"
                                                    caption="Chủ trì" width="20%" dataType="boolean" alignment="center">
                                                </dxi-column>
                                                <dxi-column cellTemplate="selectTemplatePHXL" [allowEditing]="true"
                                                    [allowFiltering]="false" dataField="coHandling"
                                                    caption="Phối hợp xử lý " width="20%" dataType="boolean"
                                                    alignment="center">
                                                </dxi-column>
                                                <div *dxTemplate="let cell of 'selectTemplateCT'">
                                                    <dx-check-box [value]="cell.value" [(disabled)]="cell.data.disabledCT"
                                                        (onValueChanged)="onCheckBoxBoSungChanged($event, cell)">
                                                    </dx-check-box>
                                                </div>
                                                <div *dxTemplate="let cell of 'selectTemplatePHXL'">
                                                    <dx-check-box [value]="cell.value" [(disabled)]="cell.data.disabledPHXL"
                                                        (onValueChanged)="onCheckBoxBoSungChanged($event, cell)">
                                                    </dx-check-box>
                                                </div>
                                            </dx-data-grid>

                                        </dxi-item>

                                    </dx-form>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div style="display: block; margin-left: auto; margin-right: auto; width: 130px;">
                                            <dx-button [disabled]="saving" type="success" icon="fa fa-save" text="Cập nhật"
                                                (onClick)="chuyenBoSung()"></dx-button>
                                        </div>
                                    </div>

                                </dx-popup>

                                <!-- Cập nhật kết quả giải quyết -->
                                <dx-popup [width]="900" [height]="560" [showTitle]="true"
                                    title=" Cập nhật kết quả giải quyết" [dragEnabled]="false" [closeOnOutsideClick]="false"
                                    [(visible)]="popup_Visible_detail_XL">
                                    <dx-form [formData]="processingResult" [showValidationSummary]="true"
                                        validationGroup="formValidateGroup" colCount="4">

                                        <dxi-item [label]="{text: 'Ngày giải quyết'}" [colSpan]="2"
                                            dataField="processingDate" editorType="dxDateBox"
                                            [editorOptions]="{displayFormat:'dd/MM/yyyy', showClearButton: true}"
                                            [cssClass]="popUpClass()">
                                        </dxi-item>

                                        <dxi-item [label]="{text: 'Ngày cập nhật'}" [colSpan]="2" dataField="modifiedDate"
                                            editorType="dxDateBox" [cssClass]="popUpClass()"
                                            [editorOptions]="{displayFormat:'dd/MM/yyyy', showClearButton: true, value: currentDate }">
                                        </dxi-item>

                                        <dxi-item [label]="{text: 'Ý kiến giải quyết'}" dataField="processingRecommended"
                                            [colCount]="2" [colSpan]="4" editorType="dxTextArea" [cssClass]="popUpClass()"
                                            [editorOptions]="{ autoResizeEnabled: true }">
                                        </dxi-item>
                                        <dxi-item [colSpan]="4">
                                            <dxo-label text="Đơn vị xử lý"></dxo-label>

                                            <dx-data-grid #gridContainer113 id="gridContainer113" [remoteOperations]="false"
                                                [allowColumnReordering]="true" [rowAlternationEnabled]="true"
                                                [allowColumnResizing]="true" columnResizingMode="widget"
                                                [showBorders]="true" [height]="250" [dataSource]="data_DVXL_CNKQGQ">
                                                <dxo-paging [enabled]="false"></dxo-paging>
                                                <dxo-editing mode="cell" [allowUpdating]="false">
                                                </dxo-editing>
                                                <dxo-filter-row [visible]="true" placeholder="Nhập tên phòng...">
                                                </dxo-filter-row>
                                                <dxi-column [allowFiltering]="true" [allowEditing]="false"
                                                    caption="Danh sách phòng" dataField="displayName" dataType="string"
                                                    width="50%">
                                                </dxi-column>
                                                <dxi-column [allowEditing]="true" [allowFiltering]="false"
                                                    dataField="mainHandling" caption="Chủ trì" width="25%"
                                                    dataType="boolean" alignment="center">
                                                </dxi-column>
                                                <dxi-column [allowEditing]="true" [allowFiltering]="false"
                                                    dataField="coHandling" caption="Phối hợp xử lý " width="25%"
                                                    dataType="boolean" alignment="center">
                                                </dxi-column>
                                                <div *dxTemplate="let cell of 'selectTemplate'">
                                                    <dx-check-box [value]="cell.value"
                                                        (onValueChanged)="onCheckBoxChanged($event, cell)"></dx-check-box>
                                                </div>
                                            </dx-data-grid>

                                        </dxi-item>
                                    </dx-form>

                                    <div class="row">
                                        <div
                                            style="display: block; margin-left: auto; margin-right: auto; padding-top: 20px;">
                                            <dx-button [disabled]="saving" type="success" icon="fa fa-save" text="Cập nhật"
                                                (onClick)="update_KQGQ()"></dx-button>
                                        </div>
                                    </div>
                                </dx-popup>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <style>
        ::ng-deep .dx-row {
            font-size: 15px;
            white-space: normal;
        }

        /* ::ng-deep td[role="columnheader"]{
                text-align: center !important;
            }   */
    </style>



    <!-- <createNewIncommingDocument #createNewIncommingDocument editDocumentId="editDocumentId"></createNewIncommingDocument> -->
