<div class="row">
    <div class="col-lg-12">
        <div class="card card-outline-info">
            <div class="row" style="margin: 15px 20px;padding: 10px;background: #9cdee761;border-radius: 5px;">
                <div style="flex-grow: 1;">
                    <div style="font-size: 20px;font-weight: 500;">
                        <i style="margin-right: 5px" class="fa fa-file-o" aria-hidden="true"></i> {{reportName}}
                    </div>
                </div>
                <dx-button id="target" class="form_filter_config" (click)="openPopupConfig($event)"
                    [visible]="buttonStatusExportVisible">
                    <i class="fa fa-search-plus"> </i>
                </dx-button>
            </div>

            <div class="row" style="margin: 10px">
                <div class="col-md-12">
                    <form (submit)="viewreport()">
                        <dx-form [(formData)]="formData" #form [items]="listItem" validationGroup="formValidateGroup"
                            [colCount]="formColCount" [labelLocation]="form_labelLocation" labelMode="floating"
                            style="margin-bottom: 20px" (onContentReady)="onContentReadyFilter($event)">
                        </dx-form>
                        <div class="row justify-content-center" *ngIf="show_search"
                            style="margin-top: 20px; text-align: center;margin-bottom: 50px;">
                            <dx-button text="Xem" [icon]="iconClass" type="success" [useSubmitBehavior]="true"
                                validationGroup="formValidateGroup" class="mr-2 pointer btn-kcl-success"
                                [disabled]="disabled_btn_search"></dx-button>
                            <dx-button text="Hủy" icon="fa fa-arrow-left" class="pointer" (onClick)="back()">
                            </dx-button>
                        </div>
                    </form>
                    <div id="dx-form" style="display: none"></div>
                </div>

                <!-- <div class="col-md-10" style="z-index: 1;">
                    <div class="row" style="text-align: center; margin-left: -5px;">
                        <dx-button stylingMode="contained" icon="fas fa-plus" text="Thêm mới" type="success" class="pointer" style="margin-right: 5px;"
                            [width]="150" [visible]="action_button.create" (onClick)="create($event)">
                        </dx-button>
                    </div>
                </div> -->

                <!-- <div class="btn-group dropdown btn-smaller-padding" dropdown container="body"
                    style="margin-left: 10px; margin-bottom: 5px;">
                     <dx-button icon="fas fa-file-export" stylingMode="contained" type="success" class="pointer"
                        text="Xuất file template" style="margin-right: 5px;" [width]="200"
                        (onClick)="downloadTemplatee()"></dx-button> 
                </div> -->
                <div class="btn-group dropdown btn-smaller-padding" dropdown container="body"
                    style="margin-left: 10px; margin-bottom: 5px;">

                    <div *ngFor="let action of actions2">
                        <dx-button *ngIf="action.Type == 'EXPORT_EXCEL'" [icon]="iconExport" stylingMode="contained"
                            type="success" class="pointer btn-kcl-success" [disabled]="disabled_btn_export"
                            text="{{action.ActionName}}" style="margin-right: 5px;" [visible]="action_button.create"
                            width="auto" (onClick)="downloadTemplatee()">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'EXPORTMULTIPLE_WORD'" [icon]="iconWord"
                            stylingMode="contained" type="success" class="pointer btn-kcl-success"
                            [disabled]="disabled_btn_exportWord" text="{{action.ActionName}}" style="margin-right: 5px;"
                            [visible]="action_button.create" width="auto"
                            (onClick)="onMultipleItemClick($event,action)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'MULTIPLE_DIGITALSIGN'" icon="save" stylingMode="contained"
                            type="success" class="pointer btn-kcl-success" text="{{action.ActionName}}"
                            style="margin-right: 5px;" [visible]="action_button.create" width="auto"
                            (onClick)="onMultipleDigitalsign($event,action)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'POPUPFORM'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" width="auto" [visible]="action_button.create"
                            (onClick)="create_popup($event,action)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'IMPORT_FILEEXCEL'" stylingMode="contained"
                            icon="{{action.Icon}}" text="{{action.ActionName}}" type="success"
                            class="pointer btn-kcl-success" style="margin-right: 5px;" width="auto"
                            [visible]="action_button.create" (onClick)="openFileUtiity.click()">
                        </dx-button>
                        <input #openFileUtiity id="openFile" type="file" (change)="importFileExcel($event,action)"
                            style="display:none;"
                            accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
                        <dx-button *ngIf="action.Type == 'LINK'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" width="auto" [visible]="action_button.create"
                            (onClick)="create($event,action.Code)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'STORE'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="clickBtnStore($event, action, action.DataSourceID)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'SHOWCOMPONENT'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="clickBtnPopup($event, action)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'API'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="action_call_api($event,action.Code)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'API_EXPORT'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="action_call_api_export($event,action.Code)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'IMPORT'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer btn-kcl-success"
                            style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="action_import_file($event,action.Code)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'HYPERLINK'" stylingMode="contained" icon="{{action.Icon}}"
                            text="{{action.ActionName}}" type="success" class="pointer" style="margin-right: 5px;"
                            [visible]="action_button.create" (onClick)="action_hyperlink($event, action.Code)">
                        </dx-button>
                        <dx-button *ngIf="action.Type == 'STOREANDREDIRECT'" stylingMode="contained"
                            icon="{{action.Icon}}" text="{{action.ActionName}}" type="success"
                            class="pointer btn-kcl-success" style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="clickBtnStoreAndRedirect($event, action, action.DataSourceID)">
                        </dx-button>
                        <div *ngIf="action.Type == 'GROUPLABEL'" class="btn-group dropdown btn-smaller-padding" dropdown
                            container="body" style="height: 35px ;margin-right: 5px;">
                            <button class="dropdown-toggle btn btn-sm btn-kcl-success pointer" dropdownToggle>
                                <i class="{{action.Icon}}"></i>
                                <span class="dx-button-text CustomCSSGrouplabel"><b>{{action.ActionName}}</b></span>
                            </button>
                            <input #openFileUtiitygroup id="openFileGroup" type="file"
                                (change)="importFileExcel($event,actionForImport)"
                                style="display:none;visibility:hidden;"
                                accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
                            <ul class="dropdown-menu" *dropdownMenu>
                                <li *ngFor="let groupaction of actions3">
                                    <a *ngIf="groupaction.Type == 'EXPORT_EXCEL' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="downloadTemplatee()">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'EXPORTMULTIPLE_WORD' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="onMultipleItemClick($event,groupaction)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'MULTIPLE_DIGITALSIGN' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="onMultipleDigitalsign($event,groupaction)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'IMPORT_FILEEXCEL' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="selectFile(groupaction)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'STORE' && groupaction.IDGroup == action.Id"
                                        href="javascript:;"
                                        (click)="clickBtnStore($event, groupaction, groupaction.DataSourceID)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'SHOWCOMPONENT' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="clickBtnPopup($event, groupaction)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'API' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="action_call_api($event,groupaction.Code)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'API_EXPORT' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="action_call_api_export($event,groupaction.Code)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'LINK' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="create($event,groupaction.Code)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'POPUPFORM' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="create_popup($event,groupaction)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'STOREANDREDIRECT' && groupaction.IDGroup == action.Id"
                                        href="javascript:;"
                                        (click)="clickBtnStoreAndRedirect($event, groupaction, groupaction.DataSourceID)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'HYPERLINK' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="action_hyperlink($event, groupaction.Code)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                    <a *ngIf="groupaction.Type == 'IMPORT' && groupaction.IDGroup == action.Id"
                                        href="javascript:;" (click)="action_import_file($event,groupaction.Code)">
                                        <i class="{{groupaction.Icon}} pointer"
                                            style="color: #0a518f;"></i>{{groupaction.ActionName}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- <dx-button *ngIf="action.Type == 'EXPORTFORM'" stylingMode="contained"
                            icon="{{action.Icon}}" text="{{action.ActionName}}" type="success"
                            class="pointer btn-kcl-success" style="margin-right: 5px;" [visible]="action_button.create"
                            (onClick)="clickBtnStoreAndRedirect($event, action.Value, action.DataSourceID)">
                        </dx-button> -->
                        <!-- <a *ngIf="action.Type == 'STORE'" href="javascript:;"
                                (click)="action_store(d, action.Code)"><i class="{{action.Icon}} pointer" style="color: rgb(7, 88, 44);"></i>{{action.ActionName}}</a> -->
                        <!-- <a *ngIf="action.Type == 'SHOWCOMPONENT'" href="javascript:;"
                                (click)="action_show_component(d, action)"><i class="{{action.Icon}} pointer" style="color: rgb(7, 88, 44);"></i>{{action.ActionName}}</a>
                            <a *ngIf="action.Type == 'HYPERLINK'" href="javascript:;"
                                (click)="action_hyperlink(d, action.Code)"><i class="{{action.Icon}} pointer" style="color: rgb(7, 88, 44);"></i>{{action.ActionName}}</a> -->
                    </div>

                </div>
                <!-- <dx-load-panel
                [closeOnOutsideClick]="true"
                [(visible)]="isLoadPanelVisible"
                position="center"
                [height]="90"
                [width]="222">
                </dx-load-panel> -->
                <!-- [export]="{enabled: true}" -->
                <div class="col-md-12" [style.visibility]="tableVisibility" [style.display]="tableDisplay" id="table">
                    <dx-data-grid #data [columns]='column' [dataSource]="dataSourceTest3" [showRowLines]="true"
                        [showBorders]="true" [allowColumnResizing]="true" [columnAutoWidth]="true"
                        [allowColumnReordering]="true" [summary]='sumary' [wordWrapEnabled]="true"
                        (onExporting)="onExporting($event)" (onExported)="onExported($event)"
                        (onToolbarPreparing)="onToolbarPreparing($event)" (onContentReady)="onContentReady($event)"
                        [columnHidingEnabled]="columnHidingEnabled">
                        <dxo-column-fixing [enabled]="true"></dxo-column-fixing>
                        <!-- <dxo-export [enabled]="true" [fileName]="reportName" [allowExportSelectedData]="false">
                        </dxo-export> -->
                        <!-- <dxo-load-panel [enabled]="false"></dxo-load-panel> -->
                        <dxo-search-panel [visible]="true" placeholder="Nhập nội dung..." width="250">
                        </dxo-search-panel>
                        <dxo-group-panel [visible]="true"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="true"></dxo-grouping>
                        <dxo-paging [(pageSize)]="pageSize" [(pageIndex)]="pageIndex"></dxo-paging>
                        <dxo-pager visible="true" infoText="Trang {0} trên {1} ({2} dòng)"
                            [(allowedPageSizes)]="allowedPageSizes" [showPageSizeSelector]="true" [showInfo]="true">
                        </dxo-pager>
                        <dxo-selection mode="multiple">
                        </dxo-selection>
                        <div *dxTemplate="let d of 'customTemplate'">
                            <div class="btn-group dropdown btn-smaller-padding" dropdown container="body">
                                <button class="dropdown-toggle btn btn-sm btn-kcl-success pointer" dropdownToggle>
                                    <i class="fa fa-cog"></i>
                                </button>
                                <ul class="dropdown-menu" *dropdownMenu>
                                    <!-- <li *ngFor="let action of actions"> -->
                                    <li *ngFor="let action of filter_label_action(d.data,_actionsbackup)">
                                        <a *ngIf="action.Type == 'LINK'" href="javascript:;"
                                            (click)="action_link(d, action.Code)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <!-- <a *ngIf="action.Type == 'STORE'" href="javascript:;"
                                            (click)="action_store(d, action.Code, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a> -->
                                        <a *ngIf="action.Type == 'STORE'" href="javascript:;"
                                            (click)="openConfirmationDialog(d, action, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <!-- <a *ngIf="action.Type == 'STOREANDREDIRECT'" href="javascript:;"
                                            (click)="action_store_and_redirect(d, action.Code, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a> -->
                                        <a *ngIf="action.Type == 'STOREANDREDIRECT'" href="javascript:;"
                                            (click)="openConfirmationDialog(d, action, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'SHOWCOMPONENT'" href="javascript:;"
                                            (click)="action_show_component(d, action)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'POPUPFORM'" href="javascript:;"
                                            (click)="action_show_formpopup(d, action)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'HYPERLINK'" href="javascript:;"
                                            (click)="action_hyperlink(d, action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STORE_FILECOPY_DOC'" href="javascript:;"
                                            (click)="action_store_filecopy(d, action.Code, action.DataSourceID, 1)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STORE_FILECOPY_ODOC'" href="javascript:;"
                                            (click)="action_store_filecopy(d, action.Code, action.DataSourceID, 2)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'API'" href="javascript:;"
                                            (click)="action_call_api(d,action.Code)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'API_EXPORT'" href="javascript:;"
                                            (click)="action_call_api_export(d,action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'IMPORT'" href="javascript:;"
                                            (click)="action_import_file(d,action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'EXPORTFORM'" href="javascript:;"
                                            (click)="clickExportForm(d, action)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div *dxTemplate="let data of 'totalGroupCount'">
                            <div style="font-style: italic;">
                                <span>Có <b>{{totalCount}}</b> kết quả tìm kiếm</span>
                            </div>
                        </div>

                        <div *dxTemplate="let cell of 'attachmentCellTemplate'">
                            <i *ngIf="cell.value != undefined && cell.value != ''" class="fas fa-paperclip"
                                (click)="attachment(cell.value)" style="color:#1876d3; cursor: pointer;"></i>
                        </div>
                    </dx-data-grid>
                </div>

                <div id="dx-grid" style="display: none"></div>
                <!-- Tree list show -->
                <div class="col-md-12" [style.visibility]="treeListVisibility" [style.display]="treeListDisplay"
                    id="treeList">
                    <dx-tree-list #treeList [columns]='column' [dataSource]="dataSourceTest3" [showRowLines]="true"
                        [showBorders]="true" [allowColumnResizing]="true" [columnAutoWidth]="false"
                        [allowColumnReordering]="true" [wordWrapEnabled]="true" [autoExpandAll]="expanded"
                        (onToolbarPreparing)="onToolbarPreparingTreeList($event)"
                        (onContentReady)="onContentReadyTreeList($event)" [columnHidingEnabled]="columnHidingEnabled"
                        keyExpr="Id" parentIdExpr="parentId">
                        <dxo-search-panel [visible]="true" width="250"></dxo-search-panel>
                        <dxo-selection mode="multiple"></dxo-selection>
                        <dxo-column-fixing [enabled]="true"></dxo-column-fixing>
                        <dxo-scrolling mode="standard"></dxo-scrolling>
                        <dxo-paging [enabled]="true" [(pageSize)]="pageSizeTreeList" [(pageIndex)]="pageIndexTreeList">
                        </dxo-paging>
                        <dxo-pager [visible]="true" infoText="Trang {0} trên {1} ({2} dòng)"
                            [(allowedPageSizes)]="allowedPageSizes" [showPageSizeSelector]="true" [showInfo]="true">
                        </dxo-pager>
                        <div *dxTemplate="let d of 'customTemplate'">
                            <div class="btn-group dropdown btn-smaller-padding" dropdown container="body">
                                <button class="dropdown-toggle btn btn-sm btn-kcl-success pointer" dropdownToggle>
                                    <i class="fa fa-cog"></i>
                                </button>
                                <ul class="dropdown-menu" *dropdownMenu>
                                    <!-- <li *ngFor="let action of actions"> -->
                                    <li *ngFor="let action of filter_label_action(d.data,_actionsbackup)">
                                        <a *ngIf="action.Type == 'LINK'" href="javascript:;"
                                            (click)="action_link(d, action.Code)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STORE'" href="javascript:;"
                                            (click)="action_store(d, action.Code, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'SHOWCOMPONENT'" href="javascript:;"
                                            (click)="action_show_component(d, action)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'HYPERLINK'" href="javascript:;"
                                            (click)="action_hyperlink(d, action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STORE_FILECOPY_DOC'" href="javascript:;"
                                            (click)="action_store_filecopy(d, action.Code, action.DataSourceID, 1)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STORE_FILECOPY_ODOC'" href="javascript:;"
                                            (click)="action_store_filecopy(d, action.Code, action.DataSourceID, 2)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'API'" href="javascript:;"
                                            (click)="action_call_api(d,action.Code)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'API_EXPORT'" href="javascript:;"
                                            (click)="action_call_api_export(d,action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'IMPORT'" href="javascript:;"
                                            (click)="action_import_file(d,action.Code)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'STOREANDREDIRECT'" href="javascript:;"
                                            (click)="action_store_and_redirect(d, action.Code, action.DataSourceID)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'EXPORTFORM'" href="javascript:;"
                                            (click)="clickExportForm(d, action)"><i class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                        <a *ngIf="action.Type == 'POPUPFORM'" href="javascript:;"
                                            (click)="action_show_formpopup(d, action)"><i
                                                class="{{action.Icon}} pointer"
                                                style="color: #0a518f;"></i>{{action.ActionName}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div *dxTemplate="let data of 'totalGroupCount'">
                            <div style="font-style: italic;">
                                <span>Có <b>{{totalCount}}</b> kết quả tìm kiếm</span>
                            </div>
                        </div>

                        <div *dxTemplate="let cell of 'attachmentCellTemplate'">
                            <i *ngIf="cell.value != undefined && cell.value != ''" class="fas fa-paperclip"
                                (click)="attachment(cell.value)" style="color:#1876d3; cursor: pointer;"></i>
                        </div>

                    </dx-tree-list>

                </div>
                <div id="dx-tree-list" style="display: none"></div>


                <div class="col-md-12" [style.visibility]="barChartVisibility" [style.display]="barChartDisplay"
                    id="barChart">
                    <div>
                        <dx-chart [dataSource]="barChartDataSource" (onPointClick)="pointClick($event)">
                            <dxo-series-template [nameField]="seriesField"> </dxo-series-template>
                            <dxo-argument-axis>
                                <dxo-label [displayMode]="displayMode" [rotationAngle]="rotationAngle">
                                </dxo-label>
                            </dxo-argument-axis>
                            <dxo-common-series-settings [argumentField]="ArgumentField" type="bar"
                                [valueField]="ValueField">
                                <dxo-label [visible]="true" [format]="{ formatter: formatService.formatNumber }"
                                    backgroundColor="transparent">
                                    <dxo-font [size]="11" [weight]="900" color="green"></dxo-font>
                                </dxo-label>
                            </dxo-common-series-settings>
                            <dxo-legend verticalAlignment="right" horizontalAlignment="top">
                            </dxo-legend>
                            <dxo-export [enabled]="true"></dxo-export>
                        </dx-chart>
                    </div>

                </div>
                <div class="col-md-12" [style.visibility]="pieChartVisibility" [style.display]="pieChartDisplay"
                    id="pieChart">
                    <dx-pie-chart id="pie" [size]="size" palette="bright" [dataSource]="pieChartDataSource"
                        (onPointClick)="pointClick($event)">
                        <dxi-series [argumentField]="ArgumentField" [valueField]="ValueField">
                            <dxo-label [visible]="true">
                                <dxo-connector [visible]="true" [width]="1"></dxo-connector>
                            </dxo-label>
                        </dxi-series>
                        <dxo-size [width]="500"></dxo-size>
                        <dxo-export [enabled]="true"></dxo-export>
                        <dxo-legend verticalAlignment="bottom" horizontalAlignment="center" itemTextPosition="right">
                        </dxo-legend>
                    </dx-pie-chart>
                </div>

                <!-- TaskBoard (Type = 1000) -->
                <!-- <div class="col-md-12" [style.visibility]="taskBoardVisibility" [style.display]="taskBoardDisplay"
                    id="taskboardID" style="width: 100%; height: auto;">
                    <mat-card>
                        <mat-card-content>
                            <div class="taskboard page-height" cdkDropListGroup>
                                <div class="taskboard-wrapper" *ngFor="let item of taskBoardDataSource">
                                    <div class="taskboard-list todos">
                                        <div class="taskboard-header text-uppercase">
                                            <strong>{{item.column_name}}</strong>
                                        </div>
                                        <div class="taskboard-cards" [cdkDropListData]="item.listdataResult" cdkDropList
                                            (cdkDropListDropped)="drop($event,item)" id="{{item.id}}"
                                            [cdkDropListDisabled]="item.isReadOnly == 1 ? 'true' : 'false'">
                                            <div class="taskboard-task" cdkDrag [cdkDragData]="task"
                                                *ngFor="let task of item.listdataResult" id="{{task.id}}"
                                                [ngClass]="task.class" [ngStyle]="{background: task.color}"
                                                [cdkDragDisabled]="task.isReadOnly">
                                                <!-- (mouseover)="show(task.id)" (mouseout)="hide(task.id)" 
                                                <div class="taskboard-task-title">
                                                    <b>#{{task.id}}_{{task.title}}</b>
                                                </div>
                                                <span>
                                                    <div style="text-transform: uppercase">PROJECT: {{task.nameproject}}
                                                    </div>
                                                    <div>Parent task: {{task.parentname}} </div>
                                                    <div>Status: {{task.status}} </div>
                                                </span>
                                                <div style="display: flex">
                                                    <p *ngFor="let action of actions" style="margin-right: 10px">
                                                        <a *ngIf="action.Type == 'LINK'" href="javascript:;"
                                                            (click)="action_link_taskboard(task, action.Code)"><b
                                                                class="{{action.Icon}} pointer"
                                                                style="color: #000101;"></b>
                                                        </a>
                                                        <a *ngIf="action.Type == 'STORE'" href="javascript:;"
                                                            (click)="action_store_taskboard(task, action.Code, action.DataSourceID)">
                                                            <b class="{{action.Icon}} pointer"
                                                                style="color: #000101;"></b>
                                                        </a>
                                                        <a *ngIf="action.Type == 'POPUPFORM'" href="javascript:;"
                                                            (click)="action_show_formpopup(task, action)"><b
                                                                class="{{action.Icon}} pointer"
                                                                style="color: #000101;"></b>
                                                        </a>
                                                    </p>
                                                </div>
                                                 <div *ngIf="showit && task.id == idx">Description:
                                                    {{task.description}}</div> 
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </div> -->
                <!-- Gantt -->
                <div *ngIf="displayType == 12" class="col-md-12" [style.visibility]="ganttChartVisibility"
                    id="ganttChart">
                    <dx-gantt #gantt width="auto" [taskListWidth]="450" height="900" scaleType="days"
                        [showRowLines]="true" (onTaskEditDialogShowing)="onTaskEditRedirectToForm($event)"
                        (onCustomCommand)="onCustomCommandClick($event)"
                        (onDependencyInserting)="onDependencyInserting($event)" [startDateRange]="startDateRange"
                        [endDateRange]="endDateRange" (onDependencyInserted)="onDependencyInserted($event)"
                        (onTaskUpdating)="onTaskUpdating($event)" taskContentTemplate="">
                        <dxo-context-menu [items]="contextMenuItems"></dxo-context-menu>
                        <dxi-strip-line [start]="currentTime" title="Thời gian hiện tại" cssClass="current-time">
                        </dxi-strip-line>
                        <dxo-tasks [dataSource]="ganttChartTaskDataSource"></dxo-tasks>
                        <dxo-dependencies [dataSource]="ganttChartDependencyDataSource"></dxo-dependencies>
                        <dxo-resources [dataSource]="ganttChartResourceDataSource">
                        </dxo-resources>
                        <dxo-resource-assignments [dataSource]="ganttChartAssignmentDataSource">
                        </dxo-resource-assignments>
                        <dxi-column dataField="title" caption="TÊN TASK" [width]="300" cellTemplate="titleTemplate">
                        </dxi-column>
                        <dxi-column dataField="start" headerCellTemplate="startDate" cellTemplate="" dataType="date"
                            [width]="75" format="dd/MM/yy"></dxi-column>
                        <dxi-column dataField="end" headerCellTemplate="endDate" cellTemplate="" caption="Ngày kết thúc"
                            [width]="75" dataType="date" format="dd/MM/yy"></dxi-column>
                        <dxo-toolbar>
                            <dxi-item name="collapseAll"></dxi-item>
                            <dxi-item name="expandAll"></dxi-item>
                            <dxi-item name="zoomIn"></dxi-item>
                            <dxi-item name="zoomOut"></dxi-item>
                            <dxi-item widget="dxButton" [options]="customButtonOptions"> </dxi-item>
                        </dxo-toolbar>
                        <dxo-validation [autoUpdateParentTasks]="true"></dxo-validation>
                        <dxo-editing [enabled]="true"></dxo-editing>
                        <dxo-sorting mode="multiple" [showSortIndexes]="true" ascendingText="Tăng dần"
                            descendingText="Giảm dần" clearText="Clear">
                        </dxo-sorting>
                        <dxo-scale-type-range [min]="hours" [max]="months">
                        </dxo-scale-type-range>
                        <dxo-load-panel [enabled]="true">
                        </dxo-load-panel>
                        <div *dxTemplate="let d of 'startDate'">
                            <div>NGÀY</div>
                            <div>BẮT ĐẦU</div>
                        </div>
                        <div *dxTemplate="let d of 'endDate'">
                            <div>NGÀY</div>
                            <div>KẾT THÚC</div>
                        </div>
                        <div *dxTemplate="let d of 'titleTemplate'">
                            <div *ngIf="d.key.includes('pr');then thenBlock else elseBlock"></div>
                            <ng-template #thenBlock><span style="color:red;font-weight:500"> {{ d.text }} </span>
                            </ng-template>
                            <ng-template #elseBlock>{{ d.text }}</ng-template>
                        </div>
                        <div *dxTemplate="let item of 'taskContentTemplate'" class="custom-task "
                            style.width="{{ item.taskSize.width }}px"
                            [ngStyle]="{'background-color': colorTask, 'top': topTask}">
                            <!-- <div class="custom-task-img-wrapper">
                                <img class="custom-task-img" attr.src="{{ getImagePath(item.taskData.id) }}" />
                            </div> -->
                            <div class="custom-task-wrapper">
                                <div class="custom-task-title">{{ item.taskData.title }}</div>
                                <div class="custom-task-row">{{ customTaskResources(item.taskResources) }}</div>
                            </div>
                            <div class="custom-task-progress" style.width="{{ item.taskData.progress }}%"></div>
                        </div>
                        <div *dxTemplate="let task of 'taskTooltipContentTemplate'" class="custom-task-edit-tooltip">
                            <div class="custom-tooltip-title">{{ task.title }}</div>
                            <div class="custom-tooltip-row">{{ task.resources }}</div>
                            <div class="custom-tooltip-row">{{ task.start }}</div>
                            <div class="custom-tooltip-row">{{ task.end }}</div>
                            <div class="custom-tooltip-row">{{ task.progress }}</div>
                            <div class="custom-tooltip-row"><span> Estimate Time: </span>{{ task.estimate_hours }}<span> giờ </span></div>
                            <div class="custom-tooltip-row"><span> Spent Time: </span>{{ task.totalTime }}<span> giờ
                                </span></div>
                        </div>
                    </dx-gantt>

                </div>
            </div>
        </div>
    </div>

    <!-- <div class="row">
        <dx-popup [width]="popupWidth" [height]="popupHeight" [showTitle]="false" title="Information"
            [dragEnabled]="true" [closeOnOutsideClick]="true" [(visible)]="popupVisible">
            <div *dxTemplate="let data of 'content'">
                <ng-container *ngComponentOutlet="componentPopup.component;
                ndcDynamicInputs: componentPopup.inputs;
                ndcDynamicOutputs: componentPopup.outputs"></ng-container>
            </div>
        </dx-popup>
        <dx-popup [width]="popupImgWidth" [height]="popupImgHeight" [showTitle]="false" title="Information"
            [dragEnabled]="true" [closeOnOutsideClick]="true" [(visible)]="popupImgVisible">
            <div *dxTemplate="let data of 'content'">
                <ng-container *ngComponentOutlet="componentPopup.component;
                ndcDynamicInputs: componentPopup.inputs;
                ndcDynamicOutputs: componentPopup.outputs"></ng-container>
            </div>
        </dx-popup>
        <dx-popup [width]="popupListWidth" [height]="popupListHeight" [showTitle]="false" title="Information"
            [dragEnabled]="true" [closeOnOutsideClick]="true" [(visible)]="popupListVisible">
            <div *dxTemplate="let data of 'content'">
                <ng-container *ngComponentOutlet="componentPopup.component;
                ndcDynamicInputs: componentPopup.inputs;
                ndcDynamicOutputs: componentPopup.outputs"></ng-container>
            </div>
        </dx-popup>
        <dx-popup *ngIf="popupFormVisible" [width]="popupFormWidth" [height]="popupFormHeight" [showTitle]="true"
            title="" [closeOnOutsideClick]="true" [dragEnabled]="true" [showCloseButton]="true"
            [(visible)]="popupFormVisible">
            <dx-scroll-view width="100%" height="100%">
                <dynamicFormViewer *ngIf="view_only==1" [formId]="formidpopup" [recordId]="recordidpopup"
                    [query_params]="query_params_popup" [dataId]="dataid" [label_code_popup]="labelcodepopup"
                    [popupFormVisible]="popupFormVisible" [formcodepopup]="formCode"
                    (visibleFormpopup)="ClosePopupForm($event)">
                </dynamicFormViewer>
                <dynamicFormViewOnly *ngIf="view_only==2" [formId]="formidpopup" [recordId]="recordidpopup"
                    [query_params]="query_params_popup" [dataId]="dataid" [label_code_popup]="labelcodepopup"
                    [popupFormVisible]="popupFormVisible" [formcodepopup]="formCode"
                    (visibleFormpopup)="ClosePopupForm($event)">
                </dynamicFormViewOnly>
            </dx-scroll-view>
        </dx-popup>
    </div> -->

    <!-- POPUP Attachment -->
    <div class="row">
        <dx-popup [width]="800" [height]="600" [showTitle]="false" title="Information" [dragEnabled]="true"
            [closeOnOutsideClick]="true" [(visible)]="popupVisibleAttachment">
            <dx-scroll-view width="100%" height="100%">
                <div>
                    <div style="background-color: #c9ddf7 !important;margin: 10px">
                        <h3 class="kt-container"
                            style="padding-top: 10px;padding-bottom: 10px;font-size: 1.2rem;font-weight: 500;color: #434349;text-transform: uppercase;">
                            <i class="kt-menu__link-icon flaticon-graphic-1"> </i>
                            File đính kèm
                        </h3>
                    </div>
                    <div class="row" style="margin: 10px; padding-top: 20px;">
                        <div class="col-md-12" id="table">
                            <dx-data-grid id="gridContainer" [dataSource]="attachmentList"
                                [allowColumnReordering]="true" [allowColumnResizing]="true" [columnAutoWidth]="true"
                                [showBorders]="true">
                                <dxo-paging [pageSize]="10"></dxo-paging>
                                <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20]"
                                    [showInfo]="true">
                                </dxo-pager>
                                <dxi-column dataField="tepDinhKem" caption="Tệp đính kèm"></dxi-column>
                                <dxi-column dataField="link" caption="Tải về" cellTemplate="detailTemplate"
                                    alignment="center" [width]="100">
                                </dxi-column>
                                <div *dxTemplate="let d of 'detailTemplate'">
                                    <div (click)="showDetail(d.value)">
                                        <span><i class="fas fa-download"></i></span>
                                    </div>
                                </div>
                            </dx-data-grid>
                        </div>
                    </div>
                </div>
            </dx-scroll-view>

        </dx-popup>
    </div>

    <!-- popup form setting config -->
    <div class="row">
        <div class="col-lg-12">
            <dx-popup #popupConfig [width]="350" height="auto" [maxHeight]="700" [showTitle]="true"
                title="Danh sách các cột xuất file" [closeOnOutsideClick]="true" [showCloseButton]="true"
                [(visible)]="popupConfigVisible">
                <dxi-toolbar-item widget="dxButton" toolbar="bottom" location="center"
                    [options]="saveFormConfigOptions">
                </dxi-toolbar-item>

                <div *dxTemplate="let data of 'content'">
                    <dx-scroll-view #scrollView width="100%" height="100%">
                        <dx-data-grid #gridFormConfig [rowAlternationEnabled]="true"
                            [dataSource]="columnExportDatasource">

                            <dxo-editing mode="cell" [allowUpdating]="true" [allowDeleting]="false"
                                [allowAdding]="false">
                            </dxo-editing>
                            <dxo-paging [enabled]="false"></dxo-paging>
                            <!-- <dxo-paging [pageSize]="10"></dxo-paging> -->
                            <dxi-column dataField="name" caption="Tên cột" [allowEditing]="false" dataType="string">
                            </dxi-column>
                            <dxi-column dataField="isExport" caption="Trạng thái" width="90" dataType="boolean">
                            </dxi-column>

                        </dx-data-grid>
                    </dx-scroll-view>
                </div>
                <dxo-position at="top" my="right top" of="#target" offset="-25 0"></dxo-position>
            </dx-popup>

            <dx-popup [width]="1000" [height]="400" [showTitle]="false" title="Information" [dragEnabled]="false"
                [closeOnOutsideClick]="false" [(visible)]="popupVisibleImport">
                <div id="file-import-container">
                    <h3 class="kt-container"
                        style="padding-top: 10px;padding-bottom: 10px;font-size: 1.2rem;font-weight: 500;color: #434349;text-transform: uppercase;">
                        <i class="kt-menu__link-icon flaticon-graphic-1"> </i>
                        Import file
                    </h3>
                    <dx-file-uploader name="file" uploadUrl="{{uploadUrl}}" (onValueChanged)="uploadFile($event)"
                        (onUploaded)="onUploaded($event)" selectButtonText="Chọn file" [multiple]="false" accept="*"
                        [allowedFileExtensions]="[fileTypeAccept]" [showFileList]="true" uploadMode="useButtons"
                        [(value)]="importFile">

                    </dx-file-uploader>
                </div>
                <dxi-toolbar-item widget="dxButton" toolbar="bottom" location="center" [disabled]="isClickedImport"
                    [options]="importPopupConfigOptions">
                </dxi-toolbar-item>
                <dxi-toolbar-item widget="dxButton" toolbar="bottom" location="center"
                    [options]="closeImportPopupConfigOptions">
                </dxi-toolbar-item>
            </dx-popup>

            <dx-popup #popup [width]="400" height="auto" [showTitle]="true" title="Chi tiết task" [dragEnabled]="false"
                [closeOnOutsideClick]="false" [showCloseButton]="true" container=".dx-viewport"
                [(visible)]="popupTaskDetailVisible">
                <dx-form #formPopup id="formTaskDetail" labelLocation="left" [colCount]="1"></dx-form>
            </dx-popup>
        </div>
    </div>